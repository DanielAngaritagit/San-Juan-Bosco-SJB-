<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Académico CSJB</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../style/profesor_calificaciones_unified.css">
</head>
<body>
    <div class="top-bar">
        <button id="menuToggle" class="menu-toggle">
            <img src="../multimedia/administrador/menu.png" alt="Menú">
        </button>
        <div class="notifications-container">
            <button id="Correo">
                <img src="../multimedia/administrador/mensaje.png" alt="Correo">
                <span id="correo-count">0</span>
            </button>
            <div id="correo-panel" class="correo-panel"></div>
            <button id="notifications-button">
                <img src="../multimedia/administrador/campana.png" alt="Notificaciones">
                <span id="notification-count">0</span>
            </button>
            <div id="notifications-panel" class="notifications-panel"></div>
        </div>
    </div>
    
    <div class="menu-container" id="sideMenu">
        <div class="profile">
            <img src="#" alt="Usuario">
            <div class="profile-info">
                <h3>Profesor</h3>
            </div>
        </div>
        <nav class="menu">
            <ul>
                <li><a href="../profesor/profesor.php" class="menu-link"><img src="../multimedia/profesor/home.png" alt=""> Inicio</a></li>
                <li><a href="../profesor/calendario.php" class="menu-link"><img src="../multimedia/profesor/calendario.png" alt=""> Calendario</a></li>
                <li><a href="../profesor/calificaciones.html" class="menu-link"><img src="../multimedia/profesor/calificaciones.png" alt=""> Calificaciones</a></li>
                <li><a href="../profesor/pqrsf.php" class="menu-link"><img src="../multimedia/profesor/pqrsf.png" alt=""> PQRSF</a></li>
                <li><a href="../profesor/ayuda.php" class="menu-link"><img src="../multimedia/profesor/ayuda.png" alt=""> Ayuda</a></li>
                <li><a href="../logout.php" class="menu-link"><img src="../multimedia/administrador/cerrar_sesion.png" alt=""> Cerrar Sesión</a></li>
            </ul>
        </nav>
    </div>

    <div class="main-content">
        <!-- Sección de Filtros -->
        <div class="csjb-card">
            <div class="card-header-csjb">
                Filtros Académicos
            </div>
            <div class="card-body p-3">
                <div class="row g-3">
                    <div class="col-md-6">
                        <select class="form-select csjb-input" id="nivelAcademico">
                            <option value="">Seleccionar Nivel</option>
                            <option value="Primaria">Primaria</option>
                            <option value="Secundaria">Secundaria</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <select class="form-select csjb-input" id="gradoSeccion">
                            <option value="">Seleccionar Grado/Sección</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Formulario Principal con Campo de Comentarios -->
        <div class="csjb-card">
            <div class="card-header-csjb">
                Registro de Calificaciones
            </div>
            <div class="card-body p-3">
                <form id="registroForm" class="row g-3 align-items-center">
                    <div class="col-md-3">
                        <select id="nombreEstudiante" class="form-select csjb-input" required>
                            <option value="">Seleccionar Estudiante</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="text" id="asignaturaInstructor" class="form-control csjb-input" 
                            value="" 
                            readonly
                            title="Asignatura asignada al instructor">
                    </div>
                    <div class="col-md-1">
                        <input type="number" id="cognitivo" class="form-control csjb-input" 
                            placeholder="Cognitivo (1-5)" min="1" max="5" step="0.1" required>
                    </div>
                    <div class="col-md-1">
                        <input type="number" id="procedimental" class="form-control csjb-input" 
                            placeholder="Procedimental (1-5)" min="1" max="5" step="0.1" required>
                    </div>
                    <div class="col-md-1">
                        <input type="number" id="actitudinal" class="form-control csjb-input" 
                            placeholder="Actitudinal (1-5)" min="1" max="5" step="0.1" required>
                    </div>
                    <div class="col-md-1">
                        <input type="number" id="prueba" class="form-control csjb-input" 
                            placeholder="Prueba (1-5)" min="1" max="5" step="0.1" required>
                    </div>
                    <!-- Nuevo campo para comentarios -->
                    <div class="col-md-2">
                        <input type="text" id="comentario" class="form-control csjb-input" 
                            placeholder="Comentario (opcional)" maxlength="100">
                    </div>
                    <div class="col-md-1">
                        <button type="submit" class="csjb-btn w-100">
                            <i class="bi bi-save"></i> Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sección de Actividades -->
        <div class="csjb-card">
            <div class="card-header-csjb">
                Calificación de Actividades
            </div>
            <div class="card-body p-3">
                <form id="formActividades" class="row g-3 align-items-center">
                    <div class="col-md-4">
                        <select id="estudianteActividad" class="form-select csjb-input" required>
                            <option value="">Seleccionar Estudiante</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <select id="tipoActividad" class="form-select csjb-input" required>
                            <option value="">Tipo de Actividad</option>
                            <option>Tarea</option>
                            <option>Ejercicio en Clase</option>
                            <option>Parcial</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="date" id="fechaActividad" class="form-control csjb-input" required>
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="puntajeActividad" class="form-control csjb-input" 
                               placeholder="Puntaje (1-5)" min="1" max="5" step="0.1" required>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="csjb-btn w-100">
                            <i class="bi bi-check2-circle"></i> Calificar
                        </button>
                    </div>
                </form>
                
                <div class="table-responsive mt-4">
                    <table class="grades-table w-100">
                        <thead>
                            <tr>
                                <th>Estudiante</th>
                                <th>Tipo</th>
                                <th>Fecha</th>
                                <th>Puntaje</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaActividades">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Historial Académico con Comentarios -->
        <div class="csjb-card">
            <div class="card-header-csjb">
                Historial Académico
            </div>
            <div class="card-body p-3">
                <div class="table-responsive">
                    <table class="grades-table w-100">
                        <thead>
                            <tr>
                                <th>Estudiante</th>
                                <th>Asignatura</th>
                                <th>Cognitivo (30%)</th>
                                <th>Procedimental (30%)</th>
                                <th>Actitudinal (20%)</th>
                                <th>Prueba (20%)</th>
                                <th>Promedio</th>
                                <th>Estado</th>
                                <th>Comentario</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaCalificaciones">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/notas.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0'); // Enero es 0!
            const dd = String(today.getDate()).padStart(2, '0');
            const todayString = `${yyyy}-${mm}-${dd}`;

            const fechaActividadInput = document.getElementById('fechaActividad');
            if (fechaActividadInput) {
                fechaActividadInput.setAttribute('min', todayString);
            }
        });
    </script>
</body>
</html>